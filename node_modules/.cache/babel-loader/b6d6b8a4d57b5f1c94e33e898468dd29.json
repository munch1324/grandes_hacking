{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _stringify = require('babel-runtime/core-js/json/stringify');\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _getIterator2 = require('babel-runtime/core-js/get-iterator');\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _configurationValidation = require('@okta/configuration-validation');\n\nvar _oktaAuthJs = require('@okta/okta-auth-js');\n\nvar _oktaAuthJs2 = _interopRequireDefault(_oktaAuthJs);\n\nvar _packageInfo = require('./packageInfo');\n\nvar _packageInfo2 = _interopRequireDefault(_packageInfo);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar containsAuthTokens = /id_token|access_token|code/;\n/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nvar Auth = function () {\n  function Auth(config) {\n    (0, _classCallCheck3.default)(this, Auth);\n    var testing = {\n      // If the config is undefined, cast it to false\n      disableHttpsCheck: !!config.disableHttpsCheck\n    }; // normalize authJS config. In this SDK, we allow underscore on certain properties, but AuthJS consistently uses camel case.\n\n    var authConfig = (0, _configurationValidation.buildConfigObject)(config);\n    (0, _configurationValidation.assertIssuer)(authConfig.issuer, testing);\n    (0, _configurationValidation.assertClientId)(authConfig.clientId);\n    (0, _configurationValidation.assertRedirectUri)(authConfig.redirectUri); // Automatically enter login flow if session has expired or was ended outside the application\n    // The default behavior can be overriden by passing your own function via config: `config.onSessionExpired`\n\n    if (!authConfig.onSessionExpired) {\n      authConfig.onSessionExpired = this.login.bind(this);\n    }\n\n    this._oktaAuth = new _oktaAuthJs2.default(authConfig);\n    this._oktaAuth.userAgent = _packageInfo2.default.name + '/' + _packageInfo2.default.version + ' ' + this._oktaAuth.userAgent;\n    this._config = authConfig; // use normalized config\n\n    this._history = config.history;\n    this.handleAuthentication = this.handleAuthentication.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.getUser = this.getUser.bind(this);\n    this.getIdToken = this.getIdToken.bind(this);\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.login = this.login.bind(this);\n    this.logout = this.logout.bind(this);\n    this.redirect = this.redirect.bind(this);\n  }\n\n  (0, _createClass3.default)(Auth, [{\n    key: 'getTokenManager',\n    value: function getTokenManager() {\n      return this._oktaAuth.tokenManager;\n    }\n  }, {\n    key: 'handleAuthentication',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n        var tokens, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, token;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this._oktaAuth.token.parseFromUrl();\n\n              case 2:\n                tokens = _context.sent;\n                tokens = Array.isArray(tokens) ? tokens : [tokens];\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context.prev = 7;\n\n                for (_iterator = (0, _getIterator3.default)(tokens); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  token = _step.value;\n\n                  if (token.idToken) {\n                    this._oktaAuth.tokenManager.add('idToken', token);\n                  } else if (token.accessToken) {\n                    this._oktaAuth.tokenManager.add('accessToken', token);\n                  }\n                }\n\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context['catch'](7);\n                _didIteratorError = true;\n                _iteratorError = _context.t0;\n\n              case 15:\n                _context.prev = 15;\n                _context.prev = 16;\n\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                  _iterator.return();\n                }\n\n              case 18:\n                _context.prev = 18;\n\n                if (!_didIteratorError) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 21:\n                return _context.finish(18);\n\n              case 22:\n                return _context.finish(15);\n\n              case 23:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 11, 15, 23], [16,, 18, 22]]);\n      }));\n\n      function handleAuthentication() {\n        return _ref.apply(this, arguments);\n      }\n\n      return handleAuthentication;\n    }()\n  }, {\n    key: 'isAuthenticated',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {\n        return _regenerator2.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!this._config.isAuthenticated) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt('return', this._config.isAuthenticated());\n\n              case 2:\n                if (!(location && location.hash && containsAuthTokens.test(location.hash))) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt('return', null);\n\n              case 4:\n                _context2.next = 6;\n                return this.getAccessToken();\n\n              case 6:\n                _context2.t0 = !!_context2.sent;\n\n                if (_context2.t0) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                _context2.next = 10;\n                return this.getIdToken();\n\n              case 10:\n                _context2.t0 = !!_context2.sent;\n\n              case 11:\n                return _context2.abrupt('return', _context2.t0);\n\n              case 12:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isAuthenticated() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return isAuthenticated;\n    }()\n  }, {\n    key: 'getUser',\n    value: function () {\n      var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {\n        var accessToken, idToken, userinfo;\n        return _regenerator2.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 2:\n                accessToken = _context3.sent;\n                _context3.next = 5;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 5:\n                idToken = _context3.sent;\n\n                if (!(accessToken && idToken)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.next = 9;\n                return this._oktaAuth.token.getUserInfo(accessToken);\n\n              case 9:\n                userinfo = _context3.sent;\n\n                if (!(userinfo.sub === idToken.claims.sub)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                return _context3.abrupt('return', userinfo);\n\n              case 12:\n                return _context3.abrupt('return', idToken ? idToken.claims : undefined);\n\n              case 13:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getUser() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return getUser;\n    }()\n  }, {\n    key: 'getIdToken',\n    value: function () {\n      var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4() {\n        var idToken;\n        return _regenerator2.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 3:\n                idToken = _context4.sent;\n                return _context4.abrupt('return', idToken.idToken);\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4['catch'](0);\n                return _context4.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function getIdToken() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getIdToken;\n    }()\n  }, {\n    key: 'getAccessToken',\n    value: function () {\n      var _ref5 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee5() {\n        var accessToken;\n        return _regenerator2.default.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 3:\n                accessToken = _context5.sent;\n                return _context5.abrupt('return', accessToken.accessToken);\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5['catch'](0);\n                return _context5.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 7]]);\n      }));\n\n      function getAccessToken() {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getAccessToken;\n    }()\n  }, {\n    key: 'login',\n    value: function () {\n      var _ref6 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee6(fromUri, additionalParams) {\n        var auth, history;\n        return _regenerator2.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                // Save the current url before redirect\n                this.setFromUri(fromUri); // will save current location if fromUri is undefined\n\n                if (!this._config.onAuthRequired) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                auth = this;\n                history = this._history;\n                return _context6.abrupt('return', this._config.onAuthRequired({\n                  auth: auth,\n                  history: history\n                }));\n\n              case 5:\n                return _context6.abrupt('return', this.redirect(additionalParams));\n\n              case 6:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function login(_x, _x2) {\n        return _ref6.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'logout',\n    value: function () {\n      var _ref7 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee7(options) {\n        var _this = this;\n\n        var path;\n        return _regenerator2.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                path = null;\n                options = options || {};\n\n                if (typeof options === 'string') {\n                  path = options;\n                  options = {};\n                }\n\n                return _context7.abrupt('return', this._oktaAuth.signOut(options).then(function () {\n                  if (!options.postLogoutRedirectUri && !_this._config.postLogoutRedirectUri) {\n                    _this._history.push(path || '/');\n                  }\n                }));\n\n              case 4:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function logout(_x3) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: 'redirect',\n    value: function () {\n      var _ref8 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee8() {\n        var additionalParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var params;\n        return _regenerator2.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                // normalize config object\n                params = (0, _configurationValidation.buildConfigObject)(additionalParams); // set defaults\n\n                params.responseType = params.responseType || this._config.responseType || ['id_token', 'token'];\n                params.scopes = params.scopes || this._config.scopes || ['openid', 'email', 'profile'];\n                return _context8.abrupt('return', this._oktaAuth.token.getWithRedirect(params));\n\n              case 4:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function redirect() {\n        return _ref8.apply(this, arguments);\n      }\n\n      return redirect;\n    }()\n  }, {\n    key: 'setFromUri',\n    value: function setFromUri(fromUri) {\n      // Use current history location if fromUri was not passed\n      var referrerPath = fromUri ? {\n        pathname: fromUri\n      } : this._history.location;\n      localStorage.setItem('secureRouterReferrerPath', (0, _stringify2.default)(referrerPath));\n    }\n  }, {\n    key: 'getFromUri',\n    value: function getFromUri() {\n      var referrerKey = 'secureRouterReferrerPath';\n      var location = JSON.parse(localStorage.getItem(referrerKey) || '{ \"pathname\": \"/\" }');\n      localStorage.removeItem(referrerKey);\n      return location;\n    }\n  }]);\n  return Auth;\n}();\n\nexports.default = Auth;","map":{"version":3,"sources":["/Users/mgrande/Desktop/js_hacking/grandes_hacking/node_modules/@okta/okta-react/dist/Auth.js"],"names":["Object","defineProperty","exports","value","_stringify","require","_stringify2","_interopRequireDefault","_regenerator","_regenerator2","_getIterator2","_getIterator3","_asyncToGenerator2","_asyncToGenerator3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_configurationValidation","_oktaAuthJs","_oktaAuthJs2","_packageInfo","_packageInfo2","obj","__esModule","default","containsAuthTokens","Auth","config","testing","disableHttpsCheck","authConfig","buildConfigObject","assertIssuer","issuer","assertClientId","clientId","assertRedirectUri","redirectUri","onSessionExpired","login","bind","_oktaAuth","userAgent","name","version","_config","_history","history","handleAuthentication","isAuthenticated","getUser","getIdToken","getAccessToken","logout","redirect","key","getTokenManager","tokenManager","_ref","mark","_callee","tokens","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","token","wrap","_callee$","_context","prev","next","parseFromUrl","sent","Array","isArray","undefined","done","idToken","add","accessToken","t0","return","finish","stop","apply","arguments","_ref2","_callee2","_callee2$","_context2","abrupt","location","hash","test","_ref3","_callee3","userinfo","_callee3$","_context3","get","getUserInfo","sub","claims","_ref4","_callee4","_callee4$","_context4","_ref5","_callee5","_callee5$","_context5","_ref6","_callee6","fromUri","additionalParams","auth","_callee6$","_context6","setFromUri","onAuthRequired","_x","_x2","_ref7","_callee7","options","_this","path","_callee7$","_context7","signOut","then","postLogoutRedirectUri","push","_x3","_ref8","_callee8","length","params","_callee8$","_context8","responseType","scopes","getWithRedirect","referrerPath","pathname","localStorage","setItem","getFromUri","referrerKey","JSON","parse","getItem","removeItem"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _stringify = require('babel-runtime/core-js/json/stringify');\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _getIterator2 = require('babel-runtime/core-js/get-iterator');\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _configurationValidation = require('@okta/configuration-validation');\n\nvar _oktaAuthJs = require('@okta/okta-auth-js');\n\nvar _oktaAuthJs2 = _interopRequireDefault(_oktaAuthJs);\n\nvar _packageInfo = require('./packageInfo');\n\nvar _packageInfo2 = _interopRequireDefault(_packageInfo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar containsAuthTokens = /id_token|access_token|code/; /*\n                                                        * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n                                                        * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n                                                        *\n                                                        * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n                                                        * Unless required by applicable law or agreed to in writing, software\n                                                        * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n                                                        * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n                                                        *\n                                                        * See the License for the specific language governing permissions and limitations under the License.\n                                                        */\n\nvar Auth = function () {\n  function Auth(config) {\n    (0, _classCallCheck3.default)(this, Auth);\n\n    var testing = {\n      // If the config is undefined, cast it to false\n      disableHttpsCheck: !!config.disableHttpsCheck\n    };\n\n    // normalize authJS config. In this SDK, we allow underscore on certain properties, but AuthJS consistently uses camel case.\n    var authConfig = (0, _configurationValidation.buildConfigObject)(config);\n    (0, _configurationValidation.assertIssuer)(authConfig.issuer, testing);\n    (0, _configurationValidation.assertClientId)(authConfig.clientId);\n    (0, _configurationValidation.assertRedirectUri)(authConfig.redirectUri);\n\n    // Automatically enter login flow if session has expired or was ended outside the application\n    // The default behavior can be overriden by passing your own function via config: `config.onSessionExpired`\n    if (!authConfig.onSessionExpired) {\n      authConfig.onSessionExpired = this.login.bind(this);\n    }\n\n    this._oktaAuth = new _oktaAuthJs2.default(authConfig);\n    this._oktaAuth.userAgent = _packageInfo2.default.name + '/' + _packageInfo2.default.version + ' ' + this._oktaAuth.userAgent;\n    this._config = authConfig; // use normalized config\n    this._history = config.history;\n\n    this.handleAuthentication = this.handleAuthentication.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.getUser = this.getUser.bind(this);\n    this.getIdToken = this.getIdToken.bind(this);\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.login = this.login.bind(this);\n    this.logout = this.logout.bind(this);\n    this.redirect = this.redirect.bind(this);\n  }\n\n  (0, _createClass3.default)(Auth, [{\n    key: 'getTokenManager',\n    value: function getTokenManager() {\n      return this._oktaAuth.tokenManager;\n    }\n  }, {\n    key: 'handleAuthentication',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n        var tokens, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, token;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this._oktaAuth.token.parseFromUrl();\n\n              case 2:\n                tokens = _context.sent;\n\n                tokens = Array.isArray(tokens) ? tokens : [tokens];\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context.prev = 7;\n                for (_iterator = (0, _getIterator3.default)(tokens); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  token = _step.value;\n\n                  if (token.idToken) {\n                    this._oktaAuth.tokenManager.add('idToken', token);\n                  } else if (token.accessToken) {\n                    this._oktaAuth.tokenManager.add('accessToken', token);\n                  }\n                }\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context['catch'](7);\n                _didIteratorError = true;\n                _iteratorError = _context.t0;\n\n              case 15:\n                _context.prev = 15;\n                _context.prev = 16;\n\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                  _iterator.return();\n                }\n\n              case 18:\n                _context.prev = 18;\n\n                if (!_didIteratorError) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 21:\n                return _context.finish(18);\n\n              case 22:\n                return _context.finish(15);\n\n              case 23:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 11, 15, 23], [16,, 18, 22]]);\n      }));\n\n      function handleAuthentication() {\n        return _ref.apply(this, arguments);\n      }\n\n      return handleAuthentication;\n    }()\n  }, {\n    key: 'isAuthenticated',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {\n        return _regenerator2.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!this._config.isAuthenticated) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt('return', this._config.isAuthenticated());\n\n              case 2:\n                if (!(location && location.hash && containsAuthTokens.test(location.hash))) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt('return', null);\n\n              case 4:\n                _context2.next = 6;\n                return this.getAccessToken();\n\n              case 6:\n                _context2.t0 = !!_context2.sent;\n\n                if (_context2.t0) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                _context2.next = 10;\n                return this.getIdToken();\n\n              case 10:\n                _context2.t0 = !!_context2.sent;\n\n              case 11:\n                return _context2.abrupt('return', _context2.t0);\n\n              case 12:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isAuthenticated() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return isAuthenticated;\n    }()\n  }, {\n    key: 'getUser',\n    value: function () {\n      var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {\n        var accessToken, idToken, userinfo;\n        return _regenerator2.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 2:\n                accessToken = _context3.sent;\n                _context3.next = 5;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 5:\n                idToken = _context3.sent;\n\n                if (!(accessToken && idToken)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.next = 9;\n                return this._oktaAuth.token.getUserInfo(accessToken);\n\n              case 9:\n                userinfo = _context3.sent;\n\n                if (!(userinfo.sub === idToken.claims.sub)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                return _context3.abrupt('return', userinfo);\n\n              case 12:\n                return _context3.abrupt('return', idToken ? idToken.claims : undefined);\n\n              case 13:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getUser() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return getUser;\n    }()\n  }, {\n    key: 'getIdToken',\n    value: function () {\n      var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4() {\n        var idToken;\n        return _regenerator2.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 3:\n                idToken = _context4.sent;\n                return _context4.abrupt('return', idToken.idToken);\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4['catch'](0);\n                return _context4.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function getIdToken() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getIdToken;\n    }()\n  }, {\n    key: 'getAccessToken',\n    value: function () {\n      var _ref5 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee5() {\n        var accessToken;\n        return _regenerator2.default.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 3:\n                accessToken = _context5.sent;\n                return _context5.abrupt('return', accessToken.accessToken);\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5['catch'](0);\n                return _context5.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 7]]);\n      }));\n\n      function getAccessToken() {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getAccessToken;\n    }()\n  }, {\n    key: 'login',\n    value: function () {\n      var _ref6 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee6(fromUri, additionalParams) {\n        var auth, history;\n        return _regenerator2.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                // Save the current url before redirect\n                this.setFromUri(fromUri); // will save current location if fromUri is undefined\n\n                if (!this._config.onAuthRequired) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                auth = this;\n                history = this._history;\n                return _context6.abrupt('return', this._config.onAuthRequired({ auth: auth, history: history }));\n\n              case 5:\n                return _context6.abrupt('return', this.redirect(additionalParams));\n\n              case 6:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function login(_x, _x2) {\n        return _ref6.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'logout',\n    value: function () {\n      var _ref7 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee7(options) {\n        var _this = this;\n\n        var path;\n        return _regenerator2.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                path = null;\n\n                options = options || {};\n                if (typeof options === 'string') {\n                  path = options;\n                  options = {};\n                }\n                return _context7.abrupt('return', this._oktaAuth.signOut(options).then(function () {\n                  if (!options.postLogoutRedirectUri && !_this._config.postLogoutRedirectUri) {\n                    _this._history.push(path || '/');\n                  }\n                }));\n\n              case 4:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function logout(_x3) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: 'redirect',\n    value: function () {\n      var _ref8 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee8() {\n        var additionalParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var params;\n        return _regenerator2.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                // normalize config object\n                params = (0, _configurationValidation.buildConfigObject)(additionalParams);\n\n                // set defaults\n\n                params.responseType = params.responseType || this._config.responseType || ['id_token', 'token'];\n\n                params.scopes = params.scopes || this._config.scopes || ['openid', 'email', 'profile'];\n\n                return _context8.abrupt('return', this._oktaAuth.token.getWithRedirect(params));\n\n              case 4:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function redirect() {\n        return _ref8.apply(this, arguments);\n      }\n\n      return redirect;\n    }()\n  }, {\n    key: 'setFromUri',\n    value: function setFromUri(fromUri) {\n      // Use current history location if fromUri was not passed\n      var referrerPath = fromUri ? { pathname: fromUri } : this._history.location;\n      localStorage.setItem('secureRouterReferrerPath', (0, _stringify2.default)(referrerPath));\n    }\n  }, {\n    key: 'getFromUri',\n    value: function getFromUri() {\n      var referrerKey = 'secureRouterReferrerPath';\n      var location = JSON.parse(localStorage.getItem(referrerKey) || '{ \"pathname\": \"/\" }');\n      localStorage.removeItem(referrerKey);\n      return location;\n    }\n  }]);\n  return Auth;\n}();\n\nexports.default = Auth;"]},"metadata":{},"sourceType":"script"}